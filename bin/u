#!/bin/bash

if [[ "$1" == "vulcan" ]]; then
  HOSTNAME=vulcan
  REMOTE=${REMOTE:-hermes}
  shift 1
elif [[ $(hostname) == "Vulcan.local" ]]; then
  HOSTNAME=vulcan
  REMOTE=${REMOTE:-hermes}
elif [[ $(hostname) == "fin" ]]; then
  HOSTNAME=fin
elif [[ $(hostname) == "athena"
     || $(hostname) == "Athena"
     || $(hostname) == "Athena.local" ]]; then
  HOSTNAME=athena
  REMOTE=${REMOTE:-vulcan}
else
  HOSTNAME=hermes
  REMOTE=${REMOTE:-vulcan}
fi

echo HOSTNAME=$HOSTNAME
echo REMOTE=$REMOTE

exec make -C $NIX_CONF -f Makefile HOSTNAME=$HOSTNAME REMOTE=$REMOTE "$@"

#!/bin/bash -e

set -eo pipefail
IFS=$'\n\t'

ARGS="$1"

build -Q || exit "Failed to build project"
shell -Q --command true || exit "Failed to enter project shell"

if [[ -f .envrc ]]; then
    direnv allow .
    rm -fr .direnv
    direnv export zsh || exit "Failed to build direnv environment"
fi
